<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="search" type="application/opensearchdescription+xml" title="ModDota" href="/opensearch.xml"><title data-react-helmet="true">Scripting Introduction | ModDota</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Scripting Introduction | ModDota"><meta data-react-helmet="true" name="description" content="Part 2 of Getting Started With Dota 2 Modding, this tutorial is meant to explain the basics of programming Dota 2 custom mods."><meta data-react-helmet="true" property="og:description" content="Part 2 of Getting Started With Dota 2 Modding, this tutorial is meant to explain the basics of programming Dota 2 custom mods."><meta data-react-helmet="true" property="og:url" content="https://moddota.com/scripting-introduction"><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://moddota.com/scripting-introduction"><link rel="stylesheet" href="/styles.feceb74b.css">
<link rel="stylesheet" href="/main.b085bf71.css">
<link rel="preload" href="/styles.0a6a52ec.js" as="script">
<link rel="preload" href="/runtime~main.7ecdb72b.js" as="script">
<link rel="preload" href="/main.8207be9f.js" as="script">
<link rel="preload" href="/1.a18d8236.js" as="script">
<link rel="preload" href="/2.fe4bd3c3.js" as="script">
<link rel="preload" href="/1be78505.9008d28d.js" as="script">
<link rel="preload" href="/ec1ed54d.78b256e1.js" as="script">
<link rel="preload" href="/f324285a.e6fd3d05.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/logo.svg" alt="ModDota"><strong class="navbar__title">ModDota</strong></a><a class="navbar__item navbar__link" href="/tutorials">Tutorials</a><a target="_blank" rel="noopener noreferrer" href="/api" class="navbar__item navbar__link">Lua API</a><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama/Javascript/API" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Panorama API</a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/gRmZgvz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><div class="searchWrapper_-F3-"><span aria-label="expand searchbar" role="button" class="searchIconButton_1Dnz" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_2eto"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/logo.svg" alt="ModDota"><strong class="navbar__title">ModDota</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/tutorials">Tutorials</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="/api" class="menu__link">Lua API</a></li><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama/Javascript/API" target="_blank" rel="noopener noreferrer" class="menu__link">Panorama API</a></li><li class="menu__list-item"><a href="https://discord.gg/gRmZgvz" target="_blank" rel="noopener noreferrer" class="menu__link">Discord</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1jis"><div class="docSidebarContainer_1kjN"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/getting-started">Getting Started</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/scripting-introduction">Scripting Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Typescript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/Typescript/typescript-introduction">Typescript Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/Typescript/typescript-ability">Abilities in Typescript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/Typescript/tooltip-generator">Tooltip Generator</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Abilities, items, modifiers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/ability-keyvalues">Ability KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/item-keyvalues">Item KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/the-importance-of-abilityspecial-values">The importance of AbilitySpecial values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/passing-abilityspecial-values-into-lua">Passing AbilitySpecial values into Lua</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/abilityduration-tooltips">AbilityDuration tooltips</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/simple-custom-ability">Simple Custom Ability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/creating-innate-abilities">Creating innate (available from level 1) abilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/making-any-ability-use-charges">Making any ability use charges</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/calling-spells-with-setcursor">Calling Spells with SetCursor</a></li><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Lua_Abilities_and_Modifiers" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Lua_Abilities_and_Modifiers" tabindex="-1">Lua Abilities and Modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-item-tutorial">Lua Item Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Lua Modifiers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-modifiers/1">Extending Hero/NPC API with lua modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-modifiers/2">Linken&#x27;s Sphere &amp; Lotus Orb</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-modifiers/3">Transformations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-modifiers/4">Enchanting Trees</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/reutilizing-built-in-modifiers">Reutilizing Built-In Modifiers</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Datadriven</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/datadriven-ability-events-modifiers">DataDriven Ability Events &amp; Modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/all-about-the-target">All about the Target</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/channeling-animations">Channeling Animations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/invisibility-ability-example">Invisibility Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/illusion-ability-example">Illusion Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/rotate-ability-example">Rotate Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/point-channeling-aoe-ability-example">Point Channeling AoE Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/apply-hero-and-creep-modifier-durations">Apply Hero and Creep modifier durations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/physics-ability-example-exorcism">Physics Ability Example - Exorcism</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Units</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/unit-keyvalues">Unit KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/unit-producing-buildings">Unit producing buildings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/creating-units-with-a-duration">Creating units with a duration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/adding-a-very-simple-ai-to-units">Adding a Very Simple AI to Units</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/simple-neutral-ai">Writing a simple AI for neutrals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/create-creature-attachwearable-blocks-directly-from-the-keyvalues">Create Creature AttachWearable blocks directly from the keyvalues</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Scripting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/custom-mana-system">Custom Mana System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/item-restrictions-requirements">Item Restrictions &amp; Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/item-drop-system">Item Drop System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/making-a-rpg-like-looting-chest">Making a &quot;rpg-like&quot; looting chest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/scripted-shop-spawning">Scripted Shop Spawning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/lava-damage">Lava damage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/using-dota-filters">Using the order filter and other filters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/particle-attachment">Particle Attachment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/vector-math">Basic Vector Math</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/precache-fixing-and-avoiding-issues">Precache, Fixing and avoiding issues</a></li><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Nettables" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Nettables" tabindex="-1">Custom NetTables</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Panorama UI</a><ul class="menu__list"><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama" tabindex="-1">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/inclusive-panorama-ui">Inclusive Panorama UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/introduction-to-panorama-ui-with-typescript">Introduction to Panorama UI with TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/keybindings">Keybindings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/dotascenepanel">DOTAScenePanel</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/button-examples">Button Examples</a></li><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Game_Setup" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Game_Setup" tabindex="-1">Custom Game Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/hiding-hud-with-sethudvisible">Hiding HUD with SetHUDVisible</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/webpack">Bundling scripts with webpack</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/react">React in Panorama</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Assets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/asset-file-type-reference">Asset File Type Reference</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Maps</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/maps/hammer-tutorials">Hammer Tutorials</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/maps/making-skip-clip-blocks-out-of-models">Making skip/clip blocks out of models</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Models</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/importing-custom-models">Importing custom models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/mdl-to-vmdl-conversion">MDL to VMDL Conversion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/adding-hitbox-to-models-without-a-bone">Adding Hitbox to Models without a Bone</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/importing-models-and-using-material-editor">Importing models and using the material editor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/exporting-models-and-materials-textures">Exporting Models and Materials/Textures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/custom-hero-models-materials-animations">Custom Hero models, materials and animations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Particles</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/particle-tutorial">Particle Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/particle-basics">Particle Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/chaos-wave-particle">Chaos Wave Particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/falling-cherry-blossom-petal-for-spring-mood-particle">Falling cherry blossom petal for spring mood particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/volcano-particle">Volcano Particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/status-effects">Status Effects</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/custom-sounds">Custom Sounds</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/extracting-and-compiling-vtex-files">Extracting and Compiling VTEX files</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/custom-minimap-icons">Custom Minimap Icons</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/useful-console-commands">Useful Console Commands</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/setting-up-your-addon-with-github">Setting Up Your Addon With GitHub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/combining-kv-files-using-base">Combining KV files using #base</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/contribute">Contribute</a></li></ul></div></div></div><main class="docMainContainer_3j_A"><div class="container padding-vert--lg docItemWrapper_1Hme"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><div style="margin-top:-10px;margin-bottom:10px"><div class="row"><div class="col"><a href="https://github.com/ModDota/moddota.github.io/edit/source/_articles/scripting-introduction.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Created on <time datetime="2015-02-18T00:00:00.000Z" class="docLastUpdatedAt_1gIo">2/18/2015</time> by <strong><a href="https://steamcommunity.com/profiles/76561198046984233">Noya</a></strong></small></em></div></div></div><header><h1 class="docTitle_cWlf">Scripting Introduction</h1></header><div class="markdown"><p>Part 2 of <a href="/articles/getting-started-with-dota-2-modding">Getting Started With Dota 2 Modding</a>, this tutorial is meant to explain the basics of programming Dota 2 custom mods.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="scripting"></a>Scripting<a aria-hidden="true" tabindex="-1" class="hash-link" href="#scripting" title="Direct link to heading">#</a></h2><p>So now you have your freshly created gamemode running and have played around the map editor a bit, it’s time to move into the programming realm of Dota 2 custom maps.</p><p>Go into your &lt;addonName&gt;/scripts/ folder. The 2 main script folders are <strong>npc</strong> and <strong>vscripts</strong>. The first holds the following .txt files:</p><ul><li>npc_<strong>abilities</strong>_custom.txt - Contains all the custom abilities of the gamemode.</li><li>npc_<strong>heroes</strong>_custom.txt - Heroes with its abilities and stats</li><li>npc_<strong>items</strong>_custom.txt - Items are abilities that go into a units inventory</li><li>npc_<strong>units</strong>_custom.txt - All the data for non-hero units like buildings or creatures.</li><li>npc_<strong>abilities</strong>_override.txt - Modified dota abilities/items with changed values.</li><li><strong>herolist</strong>.txt - List of the heroes available for picking.</li></ul><p>These files are defined using KeyValues (KV) and are the core of the the <strong>DataDriven system</strong>. While they fulfill the definition of a programming language, it’s more like a big table containing all the possible data in a static document. it uses a relatively simple syntax whose only special characters are curly braces and quotes, with alternating sets of &quot;Key&quot; and &quot;Value&quot; or &quot;Key&quot; {table} pairs, where table is another set of KeyValues.</p><p>KV will define the structure of abilities/items/units, while more elaborate behavior is handled with Lua.</p><p>Each .txt file contains its particular KVs, and when the game starts, each client (and server) will interpret them. Changes to these files won’t take effect until the game is started again, so be very aware of the syntax, as any extra/missing <code>&quot;</code> or <code>{</code> <code>}</code> will usually make all the keyvalues that come after this error unusable. Consistent <a href="https://en.wikipedia.org/wiki/Indent_style" target="_blank" rel="noopener noreferrer">indentation</a> is a good practice to learn early! KV is case-sensitive, so also pay attention to write everything like the game expects you to write.</p><p>Now it’s a good time to get your environment ready to write Dota Scripts. For this, the best way is getting Sublime Text Editor, with these 2 snippet plugins that add completions for some commonly used functions and proper syntax coloring for KV and Lua.</p><ul><li><a href="https://www.sublimetext.com/" target="_blank" rel="noopener noreferrer">Sublime Text 3</a></li><li><a href="https://github.com/bhargavrpatel/dota_kv#installation" target="_blank" rel="noopener noreferrer">Sublime Text KeyValues Package</a></li><li><a href="https://github.com/bhargavrpatel/Dota-2-Sublime-Packages#installation" target="_blank" rel="noopener noreferrer">Sublime Text Lua Package</a></li></ul><p>This will be just an introductory example to the datadriven system, to understand what goes where and how to expand it.</p><p>Start a new document in Sublime and make sure you are using Dota KV as the Syntax (press Ctrl+Shift+P and write down Dota KV to select it quickly).</p><p>We’ll be making a very simple ability that does single target damage. Start by writing the name of the ability between &quot;&quot; and no spaces. Then write BaseClass... and press Enter to insert the completion. Move through the different fields with Tab.</p><p><img src="https://puu.sh/g1Aks/252bb32b2d.png" alt="img"></p><p>A <code>&quot;BaseClass&quot;</code> is essential to every datadriven definition, it orders the game to interpret this ability/item/unit in a certain way- in this case as a datadriven ability. Stock Dota 2 Items, units and heroes have their own base classes which have &quot;hard-coded&quot; behavior that we as modders can&#x27;t change much.</p><p>AbilityTextureName can be a custom icon or any internal name of a dota ability, for example lina_laguna_blade.</p><p>Other essential KV is the AbilityBehavior, write down AbilityB and use the autocomplete</p><p><img src="https://puu.sh/g1AtQ/cda16f7138.png" alt="img"></p><p><img src="https://puu.sh/g1Avn/65fe86524c.png" alt="img"></p><p>Then we need an ability <strong>event</strong>, this is a trigger for when certain event happens to the owner of the ability. The most basic one is <code>OnSpellStart</code>, add one with the completions and you’ll see a new &quot;level&quot; within { } is created, this is known as a block. In [ACTIONS], write down a &quot;Damage&quot; action, some keys and a <code>%AbilityDamage</code> will appear. A % represents a value to be taken from somewhere else, in this case, an AbilityDamage KV. Add this last key and this first basic spell should be like this:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">&quot;test_ability&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;BaseClass&quot;             &quot;ability_datadriven&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;AbilityTextureName&quot;    &quot;lina_laguna_blade&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;MaxLevel&quot;                      &quot;1&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;AbilityBehavior&quot;       &quot;DOTA_ABILITY_BEHAVIOR_UNIT_TARGET&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;AbilityUnitTargetTeam&quot; &quot;DOTA_UNIT_TARGET_TEAM_ENEMY&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;AbilityUnitTargetType&quot; &quot;DOTA_UNIT_TARGET_HERO | DOTA_UNIT_TARGET_BASIC&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;AbilityUnitDamageType&quot; &quot;DAMAGE_TYPE_MAGICAL&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        “AbilityDamage”         &quot;500&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        &quot;OnSpellStart&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                &quot;Damage&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        &quot;Target&quot;        &quot;TARGET&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        &quot;Type&quot;          &quot;DAMAGE_TYPE_MAGICAL&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        &quot;Damage&quot;        &quot;%AbilityDamage&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><p>Now, this ability has to be added to the npc_abilities_custom.txt file for a hero or unit to be able to use it. To do this, you can either edit the file directly, or use modkit.</p><p>If editing the file directly, take extra care at the level of brackets you&#x27;re using. (Sublime Text protip: use Ctrl + [ or ] to move selected blocks of text left and right through layers of tabs)</p><p>Alternatively using <a href="https://github.com/Myll/Dota-2-ModKit" target="_blank" rel="noopener noreferrer">ModKit</a> you can choose to &quot;break&quot; this file in separate files and folders (abilities/items/units/heroes), using <strong>Combine KV</strong> it will merge the contents of the folders on to the npc custom files. Working with many small key value files is easier to maintain and debug in case of errors. Beware that if using modkit to combine KV files in this way, you should only edit the broken-up versions, as manual edits made to the final .txts themselves will be lost the next time you combine.</p><p>After following this process for the test_ability you just created, it’s time to add the ability to a hero. Open npc_heroes_custom.txt and change the &quot;Ability1&quot; value &quot;example_ability&quot; to &quot;test_ability&quot; (the ability we just made), save and it’s ready to be tested ingame.</p><p>Whenever you need a testing dummy, you can create one by writing</p><p><code>-createhero (unit_name) enemy</code></p><p>in chat, unit_name being one of the available hero names pickable or just any unit name available. It also accepts shortened names, like “ancient” instead of “ancient_apparition”. One quick command is <code>-createhero kobold enemy</code> which makes a default enemy neutral kobold. The full unit name is “npc_dota_neutral_kobold”, but the shorter command will do. You can also enable no-cooldown mode by writing <code>-wtf</code> (and <code>-unwtf</code> will disable it).</p><p>Extensive documentation and in-depth examples of the datadriven system can be found in the following links spread over various moddota tutorials.</p><ul><li><a href="/articles/datadriven-ability-breakdown-documentation">Datadriven Ability Breakdown</a></li><li><a href="/articles/datadriven-items">Datadriven Items</a></li><li><a href="/articles/datadriven-units">Datadriven Units</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="lua-scripting"></a>Lua Scripting<a aria-hidden="true" tabindex="-1" class="hash-link" href="#lua-scripting" title="Direct link to heading">#</a></h2><p>Going back to the game/scripts folder, there’s the <strong>vscripts</strong> folder. Here is the place where all the Lua scripts are placed. Lua is fairly easy to pick up and its syntax is very straightforward. For the most part, programming in Dota Lua is just knowing which API functions to use (more on this later).</p><p>There&#x27;s 4 applications for Lua in Dota:</p><ul><li>Game Logic</li><li>DataDriven RunScript</li><li>Hammer I/O</li><li>Custom UI Events</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="game-logic---barebones-structure"></a>Game Logic - Barebones Structure<a aria-hidden="true" tabindex="-1" class="hash-link" href="#game-logic---barebones-structure" title="Direct link to heading">#</a></h3><p>To understand the core structure of the Dota Lua environment, I’ll be explaining the contents of a simplified Barebones. Get one of these from <a href="https://github.com/MNoya/barebones/" target="_blank" rel="noopener noreferrer">this repository</a>, and head to the vscripts folder.</p><p>In every single gamemode, a file named addon_game_mode.lua must be present. While it is possible to add the game logic to this file (and in fact, valve did so in their holdout example), it is recommended that you reserve this file only for this 3 functions:</p><ul><li><code>Require</code>, here we put all the necessary files that will be used by the game logic, treated as libraries, meaning all the functions inside those files can be used at any point.</li><li><code>Precache</code>, when the game starts and players pick their heroes, the engine will try to load the associated models/particles/sounds to those heroes. If we’re dynamically using a resource in Lua before preloading it won’t be displayed properly.</li><li><code>Activate</code>, creates the base game mode entity and calls the initialize function.</li></ul><p><img src="https://puu.sh/g2pUC/ca4413cc48.png" alt="img"> <br> Precache function was folded in sublime</p><p>Using our barebones, you don’t need to touch this file apart from very specific situations, and all the core game logic will be coded in barebones.lua, which has been already required. We’ll call this your <em>main lua file</em> from now on.</p><p><strong>Note:</strong> For the more advanced starting template you should use BMD’s Barebones, this basic Barebones was specially designed for explaining the essential parts of the Dota Lua structure.</p><p>After addon_game_mode <code>Precache</code> &amp; <code>Activate</code> are finished, the first function to be executed in the barebones.lua file is <code>GameMode:InitGameMode()</code>.</p><p>In here the game starts by initializing all sorts of rules and functions, which are registered over the GameRules and GameMode entities. For this, many variables are defined on top of the file to help organizing options like gold settings, kills, custom levels, etc.</p><p>This is the syntax of a function applied over GameRules, with one bool parameter:</p><p><code>GameRules:SetHeroRespawnEnabled( ENABLE_HERO_RESPAWN )</code></p><p>Just as KV, Lua is Case Sensitive. Also the placement of the functions within your main Lua file doesn’t generally matter. All the script lines within a function call will be run one after another, potentially on the same <em>frame</em>; one frame in Dota is 1/30 of a second.</p><p>Note the use of <code>:</code> colon before the function. In Lua, this is how we access the various <strong>Game API functions</strong>. We say that <code>GameRules</code> is an <strong>HScript</strong> or a <strong>handle</strong>. Handles are basically huge tables, with all the pertinent info of the entity. Over the <a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Scripting/API" target="_blank" rel="noopener noreferrer">Scripting API page</a> you’ll see many different types of functions which can use different handles</p><p>Global functions don’t need any handle <code>:</code> prefix. Heroes, Creatures, Abilities and Items all have their different handle classes and attempting to call a function over an incompatible class will cause a VScript error, as pink text in console and red text on the gamescreen.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-console"></a>The Console<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-console" title="Direct link to heading">#</a></h3><p>You can access the game console by pressing the ` key.</p><p>This will provide tons of useful information for debugging. The different colors represent the various “channels” of information. By default all the channels are in the same Log: Default tab. It’s very recommended that you make your own tabs to split the log viewer.</p><p><img src="https://i.imgur.com/y2BUNcS.png" alt="img"></p><p>For Lua Scripting, we want to have a VScript Tab. Messages about the DataDriven system are in the General channel in yellow along with some other info, make a separate viewer for this too.</p><p><img src="https://puu.sh/g2nWY/22554172f6.png" alt="img"></p><p>The new tabs:</p><p><img src="https://puu.sh/g2o1O/b46e113293.png" alt="img"></p><p>The console will notify whenever a Lua scripting error happens, either when the game is being loaded (a syntax-compilation error) or at runtime. In this error, I wrote GameRules.SetHeroRespawnEnabled with <code>.</code> instead of <code>:</code></p><p><img src="https://puu.sh/g2jo2/6c85128308.png" alt="img"></p><p>You can then trace the error to that line and attempt to solve it, writing <strong>script_reload</strong> in the console to reload the script and check if it was actually fixed.</p><p>A DataDriven syntax error will usually look like this:</p><p><img src="https://puu.sh/g3HVp/27ef775669.png" alt="img"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="engine-events"></a>Engine Events<a aria-hidden="true" tabindex="-1" class="hash-link" href="#engine-events" title="Direct link to heading">#</a></h3><p>The second segment of the InitGameMode function is the <strong>Listeners</strong>:</p><p><code>ListenToGameEvent(&#x27;dota_player_gained_level&#x27;, Dynamic_Wrap(GameMode, &#x27;OnPlayerLevelUp&#x27;), self)</code></p><p>The structure of this ListenToGameEvent is read as:</p><p><strong>Whenever the dota_player_gained_level event is triggered, execute the scripts inside the OnPlayerLevelUp function.</strong></p><p><code>OnPlayerLevelUp</code> and <code>GameMode</code> are just the names of the function and main class name, normally you don’t need to worry about them, all Listeners and functions are already available in barebones, ready to be expanded. <code>Dynamic_Wrap</code> is a function to ensure that the <code>script_reload</code> command also reloads the listeners. <code>script_reload</code> restarts lua scripts at runtime, unlike DataDriven files which require the game to be fully restarted. As you can see on the barebones example there are tons of possible events, and not all of them are listed there, those are just the most used ones.</p><p>The 3rd and last main element of <code>InitGameMode</code> are self defined variables to track info. These use the <code>self.</code> entity, which is a local reference to the GameMode entity, seen through all the functions inside the main lua file. Adding information to an entity like <code>entity.</code> is loosely called “indexing” and is basically adding another entry to the big table of that entity. This is very useful because this information is stored under the entity handle visible everywhere, and won’t change until we reassign it or destroy it.</p><p>Enough theory, let’s see how this all comes together. We’ll add some simple script lines to the OnNPCSpawned function, which is the listener for <code>npc_spawned</code> and triggers every time a unit or hero entity is added to the map.</p><p>Let’s analyze the contents of the <code>OnNPCSpawned</code> default function:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- An NPC has spawned somewhere in game.  This includes heroes</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function GameMode:OnNPCSpawned(keys)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        print(&quot;[BAREBONES] NPC Spawned&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        DeepPrintTable(keys)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        local npc = EntIndexToHScript(keys.entindex)</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if npc:IsRealHero() and npc.bFirstSpawned == nil then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                npc.bFirstSpawned = true</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                GameMode:OnHeroInGame(npc)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>First line will print the string under &quot;&quot; in the VConsole. The print function is native to Lua, and accepts multiple parameters separated by commas, and concatenation of strings with <code>&quot;..&quot;</code> like this:</p><p><code>print(&quot;[BAREBONES]&quot;..&quot;NPC&quot;,&quot;Spawned&quot;)</code></p><p><code>DeepPrintTable</code> is a Global Valve-made function which will display the information of the table passed. For keys in this case, it will be the .entindex and .splitscreenplayer. The <strong>entity index</strong> is a very important number to reference the entity. Ignore splitscreenplayer, it’s just legacy source stuff and never used in Dota 2.</p><p><img src="https://puu.sh/g2iLY/54583b0b65.png" alt="img"></p><p>The next line defines a local variable. In Lua local variables have their scope limited to the block where they are declared. It is good programming style to use local variables whenever possible. Local variables help you avoid cluttering the global environment with unnecessary names. Moreover, access to local variables is faster than to global ones.</p><p><code>local npc = EntIndexToHScript(keys.entindex)</code></p><p>This is basically reading the information that is provided by the event, and storing it into a local variable within that function call. In this example all the Listener and their functions have already been processed, but for reference you can always check the <a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Scripting/Built-In_Engine_Events" target="_blank" rel="noopener noreferrer">Built-In_Engine_Events wiki page</a> to know exactly what parameters are carried by each event.</p><p>The npc local variable is an HScript, of handle type. All changes done into the npc variable will reflect on spawned unit.</p><p>The next line is a conditional, first it checks if the npc is a real hero (this excludes illusions) and it also checks if the .bFirstSpawned index (a self-defined variable) has not been assigned yet. If both conditions are true, changes the boolean value to true and calls the OnHeroInGame function.</p><p>To finish this basic Dota Lua tutorial, let’s modify the OnNPCSpawned function so that if a unit named npc_dota_neutral_kobold is spawned, wait 1 seconds and then kill itself. Added to the first if statement there’s this else-if condition:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function GameMode:OnNPCSpawned(keys)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   local npc = EntIndexToHScript(keys.entindex)</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> </span></div><div class="token-line" style="color:#393A34"><span class="token plain">   if npc:IsRealHero() and npc.bFirstSpawned == nil then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       npc.bFirstSpawned = true</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       GameMode:OnHeroInGame(npc)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   elseif npc:GetUnitName() == &quot;npc_dota_neutral_kobold&quot; then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       Timers:CreateTimer( 1.0 , function()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">           npc:ForceKill(true)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">       end)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>Here we make use of the Timers library for a simple 1.0 second delay, there are many different timer functions included and explained in timers.lua. The bool on ForceKill is to enable the death animation.</p><p style="position:relative;padding-bottom:75%"><iframe src="https://gfycat.com/ifr/DigitalDefinitiveChimpanzee?hd=0" scrolling="no" frameborder="0" allowfullscreen="" width="100%" height="100%" style="position:absolute;top:0;left:0"></iframe></p>### Tables. Tables are the most important structure we will have to use. As mentioned before, all the info on entities can be seen as a table (even though it&#x27;s technically a pointer to a C++ object), and you Get and Set the values through the various Game API functions.<p>There are some functions in the API that return a table of entity handles. </p><p>Let say you want to find all the units near the spawned kobold unit and kill them. The function <code>FindUnitsInRadius</code> can be used for this purpose, and takes a lot of parameters with different types which is worth explaining:</p><p><code>table FindUnitsInRadius(int teamNumber, Vector position, handle cacheUnit, float radius, int teamFilter, int typeFilter, int flagFilter, int order, bool canGrowCache)</code></p><p>The parameters Have to be in this order. This function is a global, so no <code>handle:</code> needed, but we need to keep the table under a variable, like this:</p><p><code>local units = FindUnitsInRadius(...)</code></p><p>For the teamNumber, finding out which team an entity is in can be done with <code>GetTeamNumber()</code> on the npc handle. As for the other Filter parameters, instead of real integers, we use a bunch of <strong>Constants</strong> that represent different number values. The complete list of Constants is <a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Scripting/Constants" target="_blank" rel="noopener noreferrer">found on this wiki page</a>.</p><p>A Vector is represented as Vector(x,y,z) coordinates. The function to get the position of  particular unit is called <code>GetAbsOrigin</code> and takes a npc handle.</p><p>As for the cache parameters, just leave it nil and false, they aren&#x27;t of much use generally.</p><p>The complete function call to get the heroes in 500 radius from the spawned kobold would be:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local units = FindUnitsInRadius( npc:GetTeamNumber(), npc:GetAbsOrigin(), nil, 500, </span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                 DOTA_UNIT_TARGET_TEAM_ENEMY, DOTA_UNIT_TARGET_HERO, </span></div><div class="token-line" style="color:#393A34"><span class="token plain">                     DOTA_UNIT_TARGET_FLAG_NONE, FIND_ANY_ORDER, false)</span></div></div></div></div></div><p>The use of extra break lines is just to make it more readable. Now we want to <strong>iterate over the entities of this table</strong>, which is done like this:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">for key,unit in pairs(units) do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    print(key,value)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    unit:ForceKill(true)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>The key,unit are the chosen names to refer to the position and value inside the <em>units</em> table, which will be read in pairs. Using &#x27;_&#x27; as the name of the key is a good convention when you want to make it clear that the first parameter wont be used. The 2nd parameter, unit, is used to itea handles of the units found.</p><p>There is one more thing to consider: the &quot;wait one frame&quot; issue. Because all units are actually spawned at the (0,0,0) coordinates and then moved to the desired position, many times you&#x27;ll need to create a 0.03 second timer (1 frame) for some scripts to work, and this is one of those cases.</p><p>So, <code>OnNPCSpawned</code> is looking like this:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function GameMode:OnNPCSpawned(keys)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local npc = EntIndexToHScript(keys.entindex)</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if npc:IsRealHero() and npc.bFirstSpawned == nil then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        npc.bFirstSpawned = true</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        GameMode:OnHeroInGame(npc)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    elseif npc:GetUnitName() == &quot;npc_dota_neutral_kobold&quot; then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Timers:CreateTimer(0.03, function() </span></div><div class="token-line" style="color:#393A34"><span class="token plain">            local units = FindUnitsInRadius( npc:GetTeamNumber(), npc:GetAbsOrigin(), nil, 500, </span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        DOTA_UNIT_TARGET_TEAM_ENEMY, DOTA_UNIT_TARGET_HERO, </span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    DOTA_UNIT_TARGET_FLAG_NONE, FIND_ANY_ORDER, false)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        for key,value in pairs(units) do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            print(key,value)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            value:ForceKill(true)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        end)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>And the result ingame:</p><p style="position:relative;padding-bottom:75%"><iframe src="https://gfycat.com/ifr/SkeletalIcyDalmatian?hd=0" scrolling="no" frameborder="0" allowfullscreen="" width="100%" height="100%" style="position:absolute;top:0;left:0"></iframe></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="datadriven-runscript"></a>DataDriven RunScript<a aria-hidden="true" tabindex="-1" class="hash-link" href="#datadriven-runscript" title="Direct link to heading">#</a></h2><p>The 2nd application for Lua in Dota 2 Modding is the <code>&quot;RunScript&quot;</code> Action, which can be called from any DataDriven Event to connect the ability or item with with a Lua Script File</p><p>RunScript creates a new instance of the lua file, so.globals don’t really apply here, all variables should be either local and/or assigned to a handle.</p><p>Splitting the lua files for each ability is a good idea as it also helps splitting the ability scripts just like with the txt files</p><p>Let’s go back to the first super simple single target damage datadriven ability and add this block to the OnSpellStart ability event:</p><p>The Syntax is like this:</p><p><img src="https://puu.sh/g2x6h/d16e2db05b.png" alt="img"></p><p>ScriptFile route is relative to the /vscripts/ folder. AbilityName is the name of the lua function inside that file.</p><p>Let&#x27;s go back to the <a href="##basicability">super basic datadriven ability</a> and add a RunScript block for a ScriptFile in a subfolder. Unlike the general Game Logic, it&#x27;s recommended to separate the lua files for each ability script, and in different folders to separate heroes, units, items, etc. At the end, organization is up to you.</p><p>Adding this block to a DD Event like OnSpellStart will make a new instance of the example_script and execute the lines defined in function ScriptedAbility.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">&quot;RunScript&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;ScriptFile&quot;    &quot;heroes/example_script.lua&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;Function&quot;      &quot;ScriptedAbility&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><p>In your vscripts folder, make a heroes folder and a example_script file with a .lua extension. I recommend setting these files to automatically open with Sublime, and set the syntax to Dota Lua.</p><p>In this example script, the event will pass some information to the first parameter of the functions, which can have any name but you&#x27;ll see most refer to this parameter as <code>keys</code> or <code>event</code>.</p><p><img src="https://puu.sh/g2y9i/dfb5db78c9.png" alt="img"></p><p>In the body, most ability scripts start by defining the local variables for the target entities which are passed by the event. This is explained more deeply in the guide <a href="/moddota.com/forums/discussion/87/all-about-the-target">All About The Target</a>, but the basic target variables visible on any script are</p><ul><li><strong>.caster</strong>, the entity that started the ability.</li><li><strong>.target</strong>, the target of the ability (can be same as the caster in some cases)</li></ul><p><strong>Example</strong></p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function ScriptedAbility( event )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local caster = event.caster</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local target = event.target</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if target:GetHealthPercent() &lt; 50 then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        target:Kill(nil, caster) -- Kills this NPC, with the params Ability and Attacker</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>This will kill the targeted unit if its Health percent is less than half, and credits the kill to the caster entity.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="scripting-examples-and-sources"></a>Scripting Examples and Sources<a aria-hidden="true" tabindex="-1" class="hash-link" href="#scripting-examples-and-sources" title="Direct link to heading">#</a></h2><p>There are plenty of examples spread all across GitHub and with the contents of this guide you should now be able to understand the scripting flow of game logic and scripted abilities. The best GitHub repo to look for ability scripts is <a href="https://github.com/Pizzalol/SpellLibrary" target="_blank" rel="noopener noreferrer">SpellLibrary</a>, a community project to rewrite every dota ability using KV and Lua.</p><p>If you want to check the scripts of a certain game on the <a href="https://steamcommunity.com/workshop/browse/?appid=570&amp;browsesort=trend&amp;section=readytouseitems" target="_blank" rel="noopener noreferrer">Custom Games Workshop</a> which hasn&#x27;t made their source public on GitHub (because they are fools), just follow these steps:</p><ol><li>Subscribe to the game. Download GCFScape if you haven&#x27;t done so yet, it can be found in <a href="https://moddota.com/forums/tools" target="_blank" rel="noopener noreferrer">moddota&#x27;s tools list on the nav-bar</a></li><li>Check the URL, steamcommunity.com/sharedfiles/filedetails/?id=<strong>copy this number</strong></li><li>Go to your Steam folder -&gt; SteamApps -&gt; workshop -&gt; content -&gt; 570 (this is the dota folder)</li><li>Search for the copied number folder</li><li>Open the .vpk file with GCFScape and extract its contents anywhere you want. Now you can access its scripts and compiled models/particles/sounds.</li></ol><p><img src="https://puu.sh/g2zNP/d1e018010e.png" alt="img"></p><p>Whenever you have a doubt about how to use a particular GameAPI function, its possible to find examples all over GitHub by just writing the name of it, additionally filtering by lua like this:</p><p><img src="https://puu.sh/g2yTG/93f1641866.png" alt="img"></p><p>Just make sure it&#x27;s actually Dota Lua and not another game API, as some of the functions might share names with other engines.</p><p>That&#x27;s all for the Scripting basics. I expect you to have more questions than when you started reading, feel free to drop all your doubts at the community&#x27;s <a href="https://discord.com/invite/tPvHaRz" target="_blank" rel="noopener noreferrer">Discord channel</a>, you&#x27;ll find help there 24/7. </p><hr></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/getting-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Getting Started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/scripting/Typescript/typescript-introduction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Typescript Introduction »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_tVyB"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scripting" class="table-of-contents__link">Scripting</a></li><li><a href="#lua-scripting" class="table-of-contents__link">Lua Scripting</a><ul><li><a href="#game-logic---barebones-structure" class="table-of-contents__link">Game Logic - Barebones Structure</a></li><li><a href="#the-console" class="table-of-contents__link">The Console</a></li><li><a href="#engine-events" class="table-of-contents__link">Engine Events</a></li></ul></li><li><a href="#datadriven-runscript" class="table-of-contents__link">DataDriven RunScript</a></li><li><a href="#scripting-examples-and-sources" class="table-of-contents__link">Scripting Examples and Sources</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/styles.0a6a52ec.js"></script>
<script src="/runtime~main.7ecdb72b.js"></script>
<script src="/main.8207be9f.js"></script>
<script src="/1.a18d8236.js"></script>
<script src="/2.fe4bd3c3.js"></script>
<script src="/1be78505.9008d28d.js"></script>
<script src="/ec1ed54d.78b256e1.js"></script>
<script src="/f324285a.e6fd3d05.js"></script>
</body>
</html>